\documentclass[12pt, a4paper]{article} % set document type and sizes

%---------------------------------------------------------------------------------------------------------------------
% Packages
%---------------------------------------------------------------------------------------------------------------------

%-------------------------------------------------------
% Useful Packages.

\usepackage{amsmath} % prints mathematical formulas
\usepackage{enumitem} % handles lists

\usepackage{multirow} % handles merging cells in tables
\usepackage{float} % adds [H] option to \begin{table}[H] to restrict floating.
% to import tables from excel and csv use http://www.tablesgenerator.com/latex_tables

\usepackage{cite} % Bibliography support 

% For Greek characters support compile with XeLaTeX and include
%\usepackage{xltxtra} % Greek support
%\usepackage{xgreek} % Greek support
%\setmainfont[Mapping=tex-text]{Garamond} % Font choice

\usepackage{listings} % To insert formatted code
\usepackage{color} % To color text

\usepackage{algpseudocode} % To insert algorithms (both needed)
\usepackage{algorithm} % To insert algorithms (both needed)

%---------------------------------------------------------------------------------------------------------------------
% Code Format Settings
%---------------------------------------------------------------------------------------------------------------------

\definecolor{dkgreen}{rgb}{0,0.6,0}
\definecolor{gray}{rgb}{0.5,0.5,0.5}
\definecolor{mauve}{rgb}{0.58,0,0.82}

\lstset{frame=tb,
  language=Java,
  aboveskip=3mm,
  belowskip=3mm,
  showstringspaces=false,
  columns=flexible,
  basicstyle={\small\ttfamily},
  numbers=none,
  numberstyle=\tiny\color{gray},
  keywordstyle=\color{blue},
  commentstyle=\color{dkgreen},
  stringstyle=\color{mauve},
  breaklines=true,
  breakatwhitespace=true,
  tabsize=3
}

%-------------------------------------------------------------------------------------------------------------------


%---------------------------------------------------------------------------------------------------------------------
% Title Section
%---------------------------------------------------------------------------------------------------------------------

\newcommand{\horrule}[1]{\rule{\linewidth}{#1}} % command for creating lines to place the title in a box

\title{	
\normalfont \normalsize 
\textsc{How GBM Machine learning algorithm works} \\ [25pt] % University name and department
\horrule{0.5pt} \\[0.4cm] % Top line
\huge Gradient Boost\\ % The report title
\horrule{2pt} \\[0.5cm] % Bottom line
}

\author{} % Author's name

\date{\today} % Today's date

%---------------------------------------------------------------------------------------------------------------------
% Main Document
%---------------------------------------------------------------------------------------------------------------------

\begin{document}

\maketitle % print title

%---------------------------------------------------------------------------------------------------------------------
% Introduction
%---------------------------------------------------------------------------------------------------------------------

\section{GBM Regression}
Specifcally we will use this data:

\begin{table}[h!]
\begin{center}
\begin{tabular}{m|l|c|r} % <-- Alignments
    
    \hline
    \hline
    
         \textbf{Height(m)}
     
       & \textbf{Favorite Color}
      
       & \textbf{Gender}
       
       & \textbf{Weight(kg)}
       
      \\
      
      \hline
      \hline
      
      1.6 & Blue  & Male   & 88\\
      1.6 & Green & Female & 76\\
      1.5 & Blue  & Female & 56\\
      1.8 & Red   & Male   & 73\\
      1.5 & Green & Male   & 77\\
      1.4 & Blue  & Female & 57\\
      
      \hline
      \hline
      
\end{tabular}
\end{center}
\end{table}

\paragraph{NOTE:} When \textbf{Gradient Boost} is used to predict a continuous value, like \textbf{Weight(kg)}, we say that we are using \textbf{Gradient Boost} for \textbf{Regression}.Using \textbf{Gradient Boost} for \textbf{Regression} is different from doing \textbf{Linear Regression}, so even though two methods are related, we do not ge them confused with each other.


\subsection{AdaBoost and Gradient Boost}

If we using these measurements to \textbf{Predict Weight} then \textbf{Adaboost} starts by building a very short tree, called a \textbf{Stump}, from the \textbf{Training Data}. The amount of say that the stump has on the final output is based on how well it compensated for those previous errors. Then \textbf{Adaboost} builds the next stump based on errors that the previous stump made.

\newline

In contrast, \textbf{Gradient Boost} starting by making a single leaf, instead of tree or stump. This leaf represents the initial guess for the \textbf{Weights} of all of the samples. When trying to predict a continuous value like \textbf{Weight} in our example, the first guess is the average value.

\begin{align*}
    \overline{Weight(kg)} = \frac{88 + 76 + 56 + 73 + 77 + 57}{6} = \textbf{71.2}\\
\end{align*}

\textbf{But}, unlike \textbf{AdaBoost}, this tree is usually larger than a stump.
That said, \textbf{Gradient Boost} still restricts the size of the tree. In this simple example - for educational purposes - , will be built tress with up to four leaves but no larger.

\paragraph{Thus}, however in practice, people often set the \textbf{maximum number of leaves} to be between \textbf{8} and \textbf{32}. Like \textbf{AdaBoost}, \textbf{GradientBoost} builds fixed sized trees based on the previous tree's errors, but using \texbf{Gradient Boost} each tree can be larger than a stump. Also, like \textbf{AdaBoost}, \texbf{Gradient Boost} scales all trees.However \textbf{Gradient} scales all treess by the same amount.

     
     
\subsection{Most Common Gradient Boost Configuration}

\paragraph{The first thing we did} is to calculate the average \textbf{Weight}. This is the first attempt at predicting someone's weight. However, \texbf{Gradient Boost} does not stop here.

\begin{align*}
    \overline{Weight(kg)} = \frac{88 + 76 + 56 + 73 + 77 + 57}{6} = \textbf{71.2}\\
\end{align*}

\paragraph{The next thing we do} is to build a tree based on the errors from the first tree. The errors that the previous tree made are the differences between the \tetxbf{The Observed Weights} and the \textbf{Predicted Weights}.So let's start by plugging in \textbf{71.2} for the \textbf{Predicted Weights}.

Specifically, \textbf{(Observed Weight - Predicted Weight):}



\begin{table}[h!]
\begin{center}
\begin{tabular}{c|r} % <-- Alignments
    
    \hline
    \hline
       
        \textbf{Observed Weight(kg)}
        
    &   \textbf{Predicted Weight(kg)}
       
      \\
      
      \hline
      \hline
      
       88 &  16.8\\
       76 &  4.8\\
       56 &  -15.2 \\
       73 &  1.8\\
       77 &  5.8\\
       57 &  -14.2\\
      
      \hline
      \hline
      
\end{tabular}
\end{center}
\end{table}

\textbf{HINT:} If it seems strange to predict the residuals instead of the original Weights, just bear with me and soon all will become clear.

\paragraph{Now, we proceed building a tree -PyCode-}:



\begin{lstlisting}

import pandas as pd
import numpy as np

#Calculating Difference Between Observed Values and Predicted(Average as single leaf)

residuals = []
average_weight = np.mean(data['Weight'])
for values in data['Weight']:
    residual_value = (values - average_weight)
    residuals.append(residual_value)
    
#Assign Residuals in Pandas DataFrame
data['residuals'] = residuals
\end{lstlisting}


\textbf{So, setting aside the reason why we are bulding a tree to Predict the Residuals for the time being, here's the tree -codely and visually-.}


\begin{lstlisting}

#Lets build a tree with

for values in data[['Gender', 'Height', 'residuals', 'Favorite_Color']].values:
    if   values[0] == 'Female' and values[1] < 1.6:
        print(f"Female and smallest than 1.6    : {values[2]}.")
    elif values[0] == 'Female' and values[1] > 1.6:
        print(f"Female and tallest than 1.6     : {values[2]}.")
    elif values[0] != 'Female' and values[3] != 'Blue':
        print(f"Male who do not like blue color : {values[2]}.")
    elif values[0] != 'Female' and values[3] == 'Blue':
        print(f"Male with favorite color blue   : {values[2]}.")
    else:
        print('--')

\end{lstlisting}

%---------------------------------------------------------------------------------------------------------------------
% Section 1
%---------------------------------------------------------------------------------------------------------------------

\section{Structures}







%---------------------------------------------------------------------------------------------------------------------
% Tables
%---------------------------------------------------------------------------------------------------------------------

\subsection{Tables}

% You can write the code of your table by hand but i highly recommend using a tool like http://www.tablesgenerator.com/latex_tables

\begin{table}[H]
\centering
\caption{A Table}
\label{tab:tbl1}
\begin{tabular}{llllllllll}
\textbf{L}                      & \textbf{o}             & \textbf{r}             & \textbf{e}             & \textbf{m}             & \textbf{i}             & \textbf{p}             & \textbf{s}             & \textbf{u}             & \textbf{m}             \\ \cline{2-10} 
\multicolumn{1}{l|}{\textbf{d}} & \multicolumn{1}{l|}{o} & \multicolumn{1}{l|}{l} & \multicolumn{1}{l|}{o} & \multicolumn{1}{l|}{r} & \multicolumn{1}{l|}{s} & \multicolumn{1}{l|}{i} & \multicolumn{1}{l|}{t} & \multicolumn{1}{l|}{a} & \multicolumn{1}{l|}{m} \\ \cline{2-10} 
\multicolumn{1}{l|}{\textbf{e}} & \multicolumn{1}{l|}{t} & \multicolumn{1}{l|}{,} & \multicolumn{1}{l|}{c} & \multicolumn{1}{l|}{o} & \multicolumn{1}{l|}{n} & \multicolumn{1}{l|}{s} & \multicolumn{1}{l|}{e} & \multicolumn{1}{l|}{c} & \multicolumn{1}{l|}{t} \\ \cline{2-10} 
\end{tabular}
\end{table}

%---------------------------------------------------------------------------------------------------------------------
% List
%---------------------------------------------------------------------------------------------------------------------

\subsection{List}

\begin{itemize}

\item

\item

\item


\end{itemize}

%---------------------------------------------------------------------------------------------------------------------
% Math
%---------------------------------------------------------------------------------------------------------------------

\subsection{Math}

% This should be the best guide available for using math in LaTeX:
% ftp://ftp.ams.org/pub/tex/doc/amsmath/short-math-guide.pdf

Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. 

\begin{equation} %begin equation
 \sum_{\substack{ % equation math, follow the aforementioned guide
		 i \in S}}
	S_i
\end{equation} % end equation

Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. \(p_(t1)=\theta^(-\frac{\Delta}{s})\) % inline math
Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.

%---------------------------------------------------------------------------------------------------------------------
% Code
%---------------------------------------------------------------------------------------------------------------------
\newpage
\subsection{Code Example}


 

%---------------------------------------------------------------------------------------------------------------------
% Algorithm
%---------------------------------------------------------------------------------------------------------------------
\newpage
\subsection{Algorithm}



\begin{algorithm}
\caption{Lorem ipsum dolor sit amet}
\begin{algorithmic}



\end{algorithmic}
\end{algorithm}

%---------------------------------------------------------------------------------------------------------------------
% Conclusions
%---------------------------------------------------------------------------------------------------------------------

\section{Conclusions}





%---------------------------------------------------------------------------------------------------------------------
% Bibliography
%---------------------------------------------------------------------------------------------------------------------

\newpage
\bibliography{Report-Template} % .bib file name. Do not add ".bib"
\bibliographystyle{IEEEtr} % Bibliography style. Find more styles at
% https://www.sharelatex.com/learn/Bibtex_bibliography_styles

%If you include bibliography without a single reference inside the document, the TeX file will not compile.

\end{document}